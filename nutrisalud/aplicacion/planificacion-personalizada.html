<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificaci√≥n Personalizada - NutriSalud</title>
    <link rel="canonical" href="https://meskeia.com/nutrisalud/aplicacion/planificacion-personalizada">
    <link rel="icon" type="image/png" href="../icon_meskeia.png">
    <style>
        :root {
            --primary: #2E86AB;
            --secondary: #A23B72;
            --accent: #F18F01;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F8F9FA;
            --bg-card: #FFFFFF;
            --text-primary: #2D3748;
            --text-secondary: #4A5568;
            --text-muted: #718096;
            --border: #E2E8F0;
            --shadow: rgba(0, 0, 0, 0.1);
            --focus: rgba(46, 134, 171, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-top: 80px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Logo meskeIA */
        .meskeia-logo-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 12px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .meskeia-logo-container:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
        }

        .meskeia-neural-network {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 4px;
            width: 32px;
            height: 32px;
        }

        .meskeia-neural-dot {
            width: 12px;
            height: 12px;
            background: linear-gradient(135deg, #2E86AB, #A23B72);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .meskeia-neural-dot:nth-child(2) { animation-delay: 0.5s; }
        .meskeia-neural-dot:nth-child(3) { animation-delay: 1s; }
        .meskeia-neural-dot:nth-child(4) { animation-delay: 1.5s; }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .meskeia-logo-text {
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .meskeia-logo-text .meske {
            background: linear-gradient(135deg, #2E86AB, #A23B72);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .meskeia-logo-text .ia {
            color: #F18F01;
        }

        /* Navegaci√≥n breadcrumb */
        .breadcrumb {
            background: var(--bg-card);
            padding: 15px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 999;
        }

        .breadcrumb-nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .breadcrumb-nav a {
            color: var(--primary);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .breadcrumb-nav a:hover {
            text-decoration: underline;
        }

        .breadcrumb-separator {
            margin: 0 10px;
            color: var(--text-muted);
        }

        /* Botones de navegaci√≥n */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-top: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .nav-btn {
            padding: 15px 30px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            flex: 1;
            max-width: 300px;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .nav-btn.secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .nav-btn.secondary:hover {
            background: #f8f9fa;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .header p {
            font-size: 1.2em;
            color: #555;
            max-width: 800px;
            margin: 0 auto;
        }

        .planning-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .profile-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .profile-section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 1.8em;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .objectives-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .objective-card {
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .objective-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .objective-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .results-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .results-section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 1.8em;
            text-align: center;
        }

        .plan-display {
            display: none;
        }

        .plan-display.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .metabolic-summary {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .metabolic-summary h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .metabolic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .metabolic-item {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .metabolic-item strong {
            display: block;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .daily-structure {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .meal-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #667eea;
        }

        .meal-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .meal-components {
            list-style: none;
        }

        .meal-components li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .meal-components li:last-child {
            border-bottom: none;
        }

        .component-benefit {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
        }

        .synergies-section {
            background: linear-gradient(135deg, #55a3ff, #003d82);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .synergies-section h4 {
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .synergy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .synergy-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
        }

        .synergy-card strong {
            display: block;
            margin-bottom: 8px;
            color: #fff;
        }

        .warnings-section {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .warnings-section h4 {
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .warning-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .warning-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
        }

        .organs-optimization {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .organs-optimization h4 {
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .organs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .organ-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
        }

        .organ-card h5 {
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .organ-foods {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .generate-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 25px auto;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .weekly-view {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }

        .weekly-view h4 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5em;
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .day-column {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .day-header {
            font-weight: 600;
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e9ecef;
        }

        .day-meals {
            font-size: 0.85em;
            line-height: 1.4;
        }

        .day-meals div {
            margin-bottom: 8px;
            padding: 5px;
            background: #f1f3f4;
            border-radius: 5px;
        }

        .shopping-list {
            margin-top: 30px;
            background: linear-gradient(135deg, #a8e6cf, #88d8c0);
            border-radius: 15px;
            padding: 25px;
            color: #2d3436;
        }

        .shopping-list h4 {
            margin-bottom: 20px;
            font-size: 1.5em;
            text-align: center;
        }

        .shopping-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .shopping-category {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 15px;
        }

        .shopping-category h5 {
            color: #00b894;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .shopping-category ul {
            list-style: none;
        }

        .shopping-category li {
            padding: 3px 0;
            font-size: 0.9em;
        }

        .shopping-category li::before {
            content: "‚úì";
            color: #00b894;
            margin-right: 8px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .planning-container {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .objectives-grid {
                grid-template-columns: 1fr;
            }

            .week-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .daily-structure {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Logo meskeIA -->
    <div class="meskeia-logo-container" onclick="window.location.href='../nutrisalud.html'" style="cursor: pointer;">
        <div class="meskeia-neural-network">
            <div class="meskeia-neural-dot"></div>
            <div class="meskeia-neural-dot"></div>
            <div class="meskeia-neural-dot"></div>
            <div class="meskeia-neural-dot"></div>
        </div>
        <div class="meskeia-logo-text">
            <span class="meske">meske</span><span class="ia">IA</span>
        </div>
    </div>

    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb">
        <div class="breadcrumb-nav">
            <a href="../nutrisalud.html">NutriSalud</a>
            <span class="breadcrumb-separator">‚Ä∫</span>
            <span>Aplicaci√≥n Pr√°ctica</span>
            <span class="breadcrumb-separator">‚Ä∫</span>
            <span>Planificaci√≥n Personalizada</span>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <h1>üéØ Planificaci√≥n Personalizada</h1>
            <p>Sistema inteligente que integra todo tu conocimiento nutricional en un plan personalizado que optimiza tu salud desde m√∫ltiples perspectivas: metab√≥lica, hormonal, cognitiva y org√°nica.</p>
        </div>

        <div class="planning-container">
            <!-- Secci√≥n de Perfil Personal -->
            <div class="profile-section">
                <h2>üìã Tu Perfil Metab√≥lico</h2>
                
                <div class="form-group">
                    <label for="age">Edad</label>
                    <input type="number" id="age" min="18" max="100" placeholder="Ej: 35">
                </div>

                <div class="form-group">
                    <label for="gender">Sexo biol√≥gico</label>
                    <select id="gender">
                        <option value="">Seleccionar...</option>
                        <option value="male">Masculino</option>
                        <option value="female">Femenino</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="weight">Peso (kg)</label>
                    <input type="number" id="weight" min="40" max="200" placeholder="Ej: 70">
                </div>

                <div class="form-group">
                    <label for="height">Altura (cm)</label>
                    <input type="number" id="height" min="140" max="220" placeholder="Ej: 170">
                </div>

                <div class="form-group">
                    <label for="activity">Nivel de actividad f√≠sica</label>
                    <select id="activity">
                        <option value="">Seleccionar...</option>
                        <option value="sedentary">Sedentario (trabajo de oficina)</option>
                        <option value="light">Ligera (1-3 d√≠as/semana)</option>
                        <option value="moderate">Moderada (3-5 d√≠as/semana)</option>
                        <option value="intense">Intensa (6-7 d√≠as/semana)</option>
                        <option value="extreme">Extrema (2 sesiones/d√≠a)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="sleep">Horas de sue√±o habituales</label>
                    <select id="sleep">
                        <option value="">Seleccionar...</option>
                        <option value="5">5 horas o menos</option>
                        <option value="6">6 horas</option>
                        <option value="7">7 horas</option>
                        <option value="8">8 horas</option>
                        <option value="9">9 horas o m√°s</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Objetivo principal</label>
                    <div class="objectives-grid">
                        <div class="objective-card" data-objective="weight-loss">
                            <div>üî•</div>
                            <div>P√©rdida de grasa</div>
                        </div>
                        <div class="objective-card" data-objective="muscle-gain">
                            <div>üí™</div>
                            <div>Ganancia muscular</div>
                        </div>
                        <div class="objective-card" data-objective="health">
                            <div>‚ù§Ô∏è</div>
                            <div>Salud general</div>
                        </div>
                        <div class="objective-card" data-objective="performance">
                            <div>‚ö°</div>
                            <div>Rendimiento</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="conditions">Condiciones espec√≠ficas</label>
                    <select id="conditions" multiple>
                        <option value="diabetes">Diabetes/Prediabetes</option>
                        <option value="hypertension">Hipertensi√≥n</option>
                        <option value="digestive">Problemas digestivos</option>
                        <option value="stress">Estr√©s cr√≥nico</option>
                        <option value="insomnia">Insomnio</option>
                        <option value="inflammation">Inflamaci√≥n cr√≥nica</option>
                        <option value="thyroid">Problemas tiroideos</option>
                    </select>
                </div>

                <button class="generate-btn" onclick="generatePersonalizedPlan()">
                    üöÄ Generar Mi Plan Personalizado
                </button>
            </div>

            <!-- Secci√≥n de Resultados -->
            <div class="results-section">
                <h2>üéØ Tu Plan Nutricional Inteligente</h2>
                <div id="planResults" class="plan-display">
                    <p style="text-align: center; color: #666; font-style: italic; margin-top: 100px;">
                        Completa tu perfil metab√≥lico para generar tu plan personalizado que integra conocimiento de macronutrientes, micronutrientes, sinergias alimentarias y optimizaci√≥n de √≥rganos espec√≠ficos.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Manejo de selecci√≥n de objetivos
        document.querySelectorAll('.objective-card').forEach(card => {
            card.addEventListener('click', function() {
                document.querySelectorAll('.objective-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // Funci√≥n principal de generaci√≥n de plan
        function generatePersonalizedPlan() {
            const profile = gatherUserProfile();
            
            if (!validateProfile(profile)) {
                alert('Por favor, completa todos los campos requeridos para generar tu plan personalizado.');
                return;
            }

            const planData = calculatePersonalizedPlan(profile);
            displayPersonalizedPlan(planData);
        }

        function gatherUserProfile() {
            const selectedObjective = document.querySelector('.objective-card.selected');
            const conditions = Array.from(document.getElementById('conditions').selectedOptions).map(option => option.value);
            
            return {
                age: parseInt(document.getElementById('age').value),
                gender: document.getElementById('gender').value,
                weight: parseFloat(document.getElementById('weight').value),
                height: parseFloat(document.getElementById('height').value),
                activity: document.getElementById('activity').value,
                sleep: parseInt(document.getElementById('sleep').value),
                objective: selectedObjective ? selectedObjective.dataset.objective : null,
                conditions: conditions
            };
        }

        function validateProfile(profile) {
            return profile.age && profile.gender && profile.weight && 
                   profile.height && profile.activity && profile.sleep && profile.objective;
        }

        function calculatePersonalizedPlan(profile) {
            // C√°lculo de TMB (Tasa Metab√≥lica Basal)
            let tmb;
            if (profile.gender === 'male') {
                tmb = 88.362 + (13.397 * profile.weight) + (4.799 * profile.height) - (5.677 * profile.age);
            } else {
                tmb = 447.593 + (9.247 * profile.weight) + (3.098 * profile.height) - (4.330 * profile.age);
            }

            // Factor de actividad
            const activityFactors = {
                'sedentary': 1.2,
                'light': 1.375,
                'moderate': 1.55,
                'intense': 1.725,
                'extreme': 1.9
            };

            const tdee = tmb * activityFactors[profile.activity];

            // Ajuste por objetivo
            let calories = tdee;
            let proteinRatio = 0.25;
            let fatRatio = 0.30;
            let carbRatio = 0.45;

            switch (profile.objective) {
                case 'weight-loss':
                    calories = tdee * 0.85; // D√©ficit del 15%
                    proteinRatio = 0.35; // Mayor prote√≠na para preservar m√∫sculo
                    fatRatio = 0.35;
                    carbRatio = 0.30;
                    break;
                case 'muscle-gain':
                    calories = tdee * 1.15; // Super√°vit del 15%
                    proteinRatio = 0.30;
                    fatRatio = 0.25;
                    carbRatio = 0.45;
                    break;
                case 'performance':
                    proteinRatio = 0.25;
                    fatRatio = 0.25;
                    carbRatio = 0.50; // M√°s carbohidratos para rendimiento
                    break;
            }

            // Ajustes por condiciones espec√≠ficas
            const adjustments = calculateConditionAdjustments(profile.conditions);

            return {
                profile: profile,
                metabolism: {
                    tmb: Math.round(tmb),
                    tdee: Math.round(tdee),
                    targetCalories: Math.round(calories),
                    protein: Math.round((calories * proteinRatio) / 4),
                    carbs: Math.round((calories * carbRatio) / 4),
                    fats: Math.round((calories * fatRatio) / 9)
                },
                adjustments: adjustments,
                dailyStructure: generateDailyStructure(profile, calories, proteinRatio, carbRatio, fatRatio),
                synergies: calculateOptimalSynergies(profile),
                organOptimization: generateOrganOptimization(profile),
                warnings: generateWarnings(profile),
                weeklyPlan: generateWeeklyPlan(profile),
                shoppingList: generateShoppingList(profile)
            };
        }

        function calculateConditionAdjustments(conditions) {
            const adjustments = [];
            
            if (conditions.includes('diabetes')) {
                adjustments.push({
                    condition: 'Diabetes/Prediabetes',
                    advice: 'Priorizar carbohidratos complejos, aumentar fibra, evitar picos gluc√©micos',
                    changes: 'Reducir carbohidratos a 35%, aumentar prote√≠na a 30%'
                });
            }
            
            if (conditions.includes('hypertension')) {
                adjustments.push({
                    condition: 'Hipertensi√≥n',
                    advice: 'Reducir sodio (<1500mg/d√≠a), aumentar potasio, magnesio y antioxidantes',
                    changes: 'Incorporar m√°s vegetales, frutas bajas en az√∫car, pescado'
                });
            }
            
            if (conditions.includes('digestive')) {
                adjustments.push({
                    condition: 'Problemas Digestivos',
                    advice: 'Aumentar fibra gradualmente, probi√≥ticos, alimentos fermentados',
                    changes: 'Distribuir comidas en 5-6 tomas, cocci√≥n suave'
                });
            }
            
            if (conditions.includes('inflammation')) {
                adjustments.push({
                    condition: 'Inflamaci√≥n Cr√≥nica',
                    advice: 'Aumentar omega-3, antioxidantes, eliminar alimentos pro-inflamatorios',
                    changes: 'M√°s pescado azul, frutos rojos, vegetales cruc√≠feros'
                });
            }

            return adjustments;
        }

        function generateDailyStructure(profile, calories, proteinRatio, carbRatio, fatRatio) {
            const meals = {
                breakfast: {
                    name: "Desayuno (25% calor√≠as)",
                    components: [],
                    timing: "7:00-8:00"
                },
                midMorning: {
                    name: "Media Ma√±ana (10% calor√≠as)",
                    components: [],
                    timing: "10:00-11:00"
                },
                lunch: {
                    name: "Almuerzo (35% calor√≠as)",
                    components: [],
                    timing: "13:00-14:00"
                },
                snack: {
                    name: "Merienda (10% calor√≠as)",
                    components: [],
                    timing: "17:00-18:00"
                },
                dinner: {
                    name: "Cena (20% calor√≠as)",
                    components: [],
                    timing: "20:00-21:00"
                }
            };

            // Desayuno optimizado
            meals.breakfast.components = [
                { food: "Avena con ar√°ndanos", benefit: "Carbohidratos complejos + antioxidantes" },
                { food: "Huevos revueltos", benefit: "Prote√≠na completa + colina cerebral" },
                { food: "Aguacate", benefit: "Grasas monoinsaturadas + fibra" },
                { food: "Nueces", benefit: "Omega-3 + vitamina E" }
            ];

            // Almuerzo balanceado
            meals.lunch.components = [
                { food: "Salm√≥n a la plancha", benefit: "Omega-3 + prote√≠na alta calidad" },
                { food: "Quinoa con vegetales", benefit: "Prote√≠na vegetal + fibra + micronutrientes" },
                { food: "Ensalada verde mixta", benefit: "Vitaminas, minerales, enzimas digestivas" },
                { food: "Aceite de oliva virgen", benefit: "Antioxidantes + absorci√≥n vitaminas" }
            ];

            // Cena ligera
            meals.dinner.components = [
                { food: "Pollo a las hierbas", benefit: "Prote√≠na magra + digesti√≥n f√°cil" },
                { food: "Verduras al vapor", benefit: "Fibra + micronutrientes preservados" },
                { food: "Batata asada", benefit: "Carbohidratos complejos + betacarotenos" }
            ];

            // Media ma√±ana
            meals.midMorning.components = [
                { food: "Yogur griego natural", benefit: "Probi√≥ticos + prote√≠na" },
                { food: "Frutos rojos", benefit: "Antioxidantes + fibra" }
            ];

            // Merienda
            meals.snack.components = [
                { food: "Hummus con verduras", benefit: "Prote√≠na vegetal + fibra" },
                { food: "T√© verde", benefit: "Antioxidantes + metabolismo" }
            ];

            return meals;
        }

        function calculateOptimalSynergies(profile) {
            return [
                {
                    combination: "Hierro + Vitamina C",
                    example: "Espinacas con pimiento rojo + lim√≥n",
                    benefit: "Aumenta absorci√≥n de hierro hasta 400%"
                },
                {
                    combination: "C√∫rcuma + Pimienta negra",
                    example: "Curry con piperina",
                    benefit: "Aumenta biodisponibilidad curcumina 2000%"
                },
                {
                    combination: "Tomate + Aceite de oliva",
                    example: "Ensalada mediterr√°nea",
                    benefit: "Mejora absorci√≥n licopeno (antioxidante)"
                },
                {
                    combination: "Calcio + Magnesio",
                    example: "Almendras + semillas de calabaza",
                    benefit: "Optimiza absorci√≥n √≥sea y funci√≥n muscular"
                },
                {
                    combination: "Legumbres + Cereales",
                    example: "Lentejas + arroz integral",
                    benefit: "Prote√≠na completa vegetal"
                }
            ];
        }

        function generateOrganOptimization(profile) {
            return {
                liver: {
                    name: "ü•º H√≠gado (Metabolismo)",
                    foods: "Br√≥coli, ajo, pomelo, t√© verde, c√∫rcuma",
                    function: "Detoxificaci√≥n y metabolismo de grasas"
                },
                brain: {
                    name: "üß† Cerebro (Neurotransmisores)",
                    foods: "Pescado azul, nueces, ar√°ndanos, chocolate negro",
                    function: "Funci√≥n cognitiva y estado de √°nimo"
                },
                heart: {
                    name: "‚ù§Ô∏è Coraz√≥n (Cardiovascular)",
                    foods: "Avena, aceite oliva, frutos secos, legumbres",
                    function: "Salud cardiovascular y presi√≥n arterial"
                },
                intestine: {
                    name: "ü¶† Intestino (Microbiota)",
                    foods: "Yogur, k√©fir, fibra, alimentos fermentados",
                    function: "Salud digestiva e inmunidad"
                }
            };
        }

        function generateWarnings(profile) {
            const warnings = [];
            
            warnings.push({
                warning: "Evitar combinaciones inhibidoras",
                detail: "T√©/caf√© con comidas principales (inhibe absorci√≥n hierro)"
            });
            
            warnings.push({
                warning: "Timing de carbohidratos",
                detail: "Concentrar carbohidratos en desayuno y pre-entrenamiento"
            });
            
            if (profile.conditions.includes('diabetes')) {
                warnings.push({
                    warning: "Control gluc√©mico",
                    detail: "Evitar frutas solas, siempre combinar con prote√≠na/grasa"
                });
            }
            
            if (profile.sleep < 7) {
                warnings.push({
                    warning: "Sue√±o insuficiente",
                    detail: "Cena ligera 3h antes de dormir, evitar cafe√≠na tarde"
                });
            }

            return warnings;
        }

        function generateWeeklyPlan(profile) {
            const days = ['Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado', 'Domingo'];
            const plan = {};
            
            days.forEach((day, index) => {
                plan[day] = {
                    breakfast: index % 2 === 0 ? "Avena con frutos rojos" : "Tostada integral con aguacate",
                    lunch: index % 3 === 0 ? "Salm√≥n con quinoa" : 
                           index % 3 === 1 ? "Pollo con vegetales" : "Legumbres con arroz",
                    dinner: index % 2 === 0 ? "Pescado con verduras" : "Ensalada completa"
                };
            });
            
            return plan;
        }

        function generateShoppingList(profile) {
            return {
                proteins: ["Salm√≥n fresco", "Pollo ecol√≥gico", "Huevos camperos", "Yogur griego", "Legumbres variadas"],
                vegetables: ["Br√≥coli", "Espinacas", "Pimientos", "Tomates", "Aguacate", "Calabaza"],
                fruits: ["Ar√°ndanos", "Manzanas", "Limones", "Fresas"],
                carbs: ["Avena integral", "Quinoa", "Arroz integral", "Batata"],
                fats: ["Aceite oliva virgen", "Nueces", "Almendras", "Semillas calabaza"],
                spices: ["C√∫rcuma", "Jengibre", "Ajo", "Pimienta negra", "Hierbas frescas"]
            };
        }

        function displayPersonalizedPlan(planData) {
            const resultsDiv = document.getElementById('planResults');
            
            resultsDiv.innerHTML = `
                <!-- Resumen Metab√≥lico -->
                <div class="metabolic-summary">
                    <h3>üìä Tu Perfil Metab√≥lico Personalizado</h3>
                    <div class="metabolic-grid">
                        <div class="metabolic-item">
                            <strong>${planData.metabolism.tmb}</strong>
                            <span>TMB (kcal)</span>
                        </div>
                        <div class="metabolic-item">
                            <strong>${planData.metabolism.tdee}</strong>
                            <span>TDEE (kcal)</span>
                        </div>
                        <div class="metabolic-item">
                            <strong>${planData.metabolism.targetCalories}</strong>
                            <span>Objetivo (kcal)</span>
                        </div>
                        <div class="metabolic-item">
                            <strong>${planData.metabolism.protein}g</strong>
                            <span>Prote√≠na</span>
                        </div>
                        <div class="metabolic-item">
                            <strong>${planData.metabolism.carbs}g</strong>
                            <span>Carbohidratos</span>
                        </div>
                        <div class="metabolic-item">
                            <strong>${planData.metabolism.fats}g</strong>
                            <span>Grasas</span>
                        </div>
                    </div>
                </div>

                <!-- Estructura Diaria -->
                <h3 style="color: #667eea; margin-bottom: 20px;">üçΩÔ∏è Estructura Diaria Optimizada</h3>
                <div class="daily-structure">
                    ${Object.entries(planData.dailyStructure).map(([key, meal]) => `
                        <div class="meal-card">
                            <h4>${meal.name}</h4>
                            <p style="color: #666; font-size: 0.9em; margin-bottom: 15px;">‚è∞ ${meal.timing}</p>
                            <ul class="meal-components">
                                ${meal.components.map(component => `
                                    <li>
                                        <span>${component.food}</span>
                                        <span class="component-benefit">${component.benefit}</span>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    `).join('')}
                </div>

                <!-- Sinergias Alimentarias -->
                <div class="synergies-section">
                    <h4>‚ö° Sinergias Alimentarias Optimizadas</h4>
                    <div class="synergy-grid">
                        ${planData.synergies.map(synergy => `
                            <div class="synergy-card">
                                <strong>${synergy.combination}</strong>
                                <div>${synergy.example}</div>
                                <div style="font-size: 0.9em; margin-top: 8px; opacity: 0.9;">${synergy.benefit}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Optimizaci√≥n por √ìrganos -->
                <div class="organs-optimization">
                    <h4>üéØ Optimizaci√≥n por √ìrganos</h4>
                    <div class="organs-grid">
                        ${Object.entries(planData.organOptimization).map(([key, organ]) => `
                            <div class="organ-card">
                                <h5>${organ.name}</h5>
                                <div class="organ-foods">${organ.foods}</div>
                                <div style="font-size: 0.85em; margin-top: 8px; opacity: 0.8;">${organ.function}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Advertencias Personalizadas -->
                ${planData.warnings.length > 0 ? `
                    <div class="warnings-section">
                        <h4>‚ö†Ô∏è Consideraciones Espec√≠ficas</h4>
                        <div class="warning-grid">
                            ${planData.warnings.map(warning => `
                                <div class="warning-card">
                                    <strong>${warning.warning}</strong>
                                    <div style="margin-top: 8px; opacity: 0.9;">${warning.detail}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}

                <!-- Ajustes por Condiciones -->
                ${planData.adjustments.length > 0 ? `
                    <div style="background: linear-gradient(135deg, #fdcb6e, #e17055); color: white; border-radius: 15px; padding: 25px; margin-bottom: 25px;">
                        <h4 style="margin-bottom: 15px;">üè• Ajustes por Condiciones Espec√≠ficas</h4>
                        ${planData.adjustments.map(adj => `
                            <div style="background: rgba(255,255,255,0.15); border-radius: 10px; padding: 15px; margin-bottom: 15px;">
                                <strong>${adj.condition}</strong>
                                <div style="margin-top: 8px;">${adj.advice}</div>
                                <div style="margin-top: 5px; font-size: 0.9em; opacity: 0.9;">üìã ${adj.changes}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}

                <!-- Planificaci√≥n Semanal -->
                <div class="weekly-view">
                    <h4>üìÖ Planificaci√≥n Semanal</h4>
                    <div class="week-grid">
                        ${Object.entries(planData.weeklyPlan).map(([day, meals]) => `
                            <div class="day-column">
                                <div class="day-header">${day}</div>
                                <div class="day-meals">
                                    <div><strong>üåÖ</strong> ${meals.breakfast}</div>
                                    <div><strong>‚òÄÔ∏è</strong> ${meals.lunch}</div>
                                    <div><strong>üåô</strong> ${meals.dinner}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Lista de Compras Inteligente -->
                <div class="shopping-list">
                    <h4>üõí Lista de Compras Inteligente</h4>
                    <div class="shopping-categories">
                        ${Object.entries(planData.shoppingList).map(([category, items]) => `
                            <div class="shopping-category">
                                <h5>${getCategoryName(category)}</h5>
                                <ul>
                                    ${items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            resultsDiv.classList.add('active');
        }

        function getCategoryName(category) {
            const names = {
                proteins: "ü•© Prote√≠nas",
                vegetables: "ü•¨ Vegetales",
                fruits: "üçé Frutas",
                carbs: "üåæ Carbohidratos",
                fats: "ü•ë Grasas Saludables",
                spices: "üåø Especias y Hierbas"
            };
            return names[category] || category;
        }
    </script>

    <!-- Navegaci√≥n entre p√°ginas -->
    <div class="container">
        <div class="nav-buttons">
            <a href="mitos-nutricionales-desmontados.html" class="nav-btn secondary">‚Üê Mitos Desmontados</a>
            <a href="../nutrisalud.html" class="nav-btn">Volver al inicio ‚Üí</a>
        </div>
    </div>
</body>
</html>